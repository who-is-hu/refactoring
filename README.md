# Refactoring

### 냄새2 - 중복코드
의도 : 어떤것을 하겠다고 술술 읽히는 코드
구현 : 의도를 수행하기 위한 절차들이 나열된 코드 (읽기힘듬)

구현을 숨기고 의도를 보여주게 => 구현을 함수로 추출하여 이름을 잘 붙히면 됨  
서비스 로직의 코드는 의도를 보여주고 구현은 도메인 객체로 숨겨야 한다고 나는 생각한다.

### 냄새3 - 긴 함수
<details>
<summary>매개변수 객체 만들기</summary>

- 같은 매개변수가 여러 메서드에 걸쳐 나타나면 묶은 자료구조만들기
- 객체에서 파생되는 필드들이 따로따로 돌아다닐때 객체 전체를 넘겨주기
  - 이때 각 함수가 객체전체에 의존하는게 맞는가, 필드에만 의존하는게 맞는가 고민을 해봐야함
</details>

<details>
<summary>함수를 명령으로 바꾸기</summary>

- 함수분리를 먼저해보고 그래도 위치가 이상한것같으면 함수를 객체로 싸서 분리하는 방법
- 그러면 클래스가 발전하면서 추후에 확장하기 좋은 구조가 될 수 있음
- 자연스럽게 SRP에도 근접하게 됨
</details>

<details>
<summary>조건문 분해하기</summary>

- 조건문의 조건 자체가 복잡해지는 경우
- 분기를 타게 되면서 코드르 이해하기 힘들어지는 경우
- => 함수 추출로 뽑아내면서 의도만 비추게  
- 이렇게 리팩터링하다보니까 다른 냄새들이 보여서 엄청좋은 듯
</details>

<details>
<summary>반복문 쪼개기</summary>

- 하나의 반복문에서 여러개 작업을 하는 경우 (성능적으로는 이게 좋긴함)
- 정말 성능적 병목이 아니라면 반복문을 작업마다 쪼개는게 좋고 (성능 문제가되면 다시 합치는게 나음)
- 루프를 쪼개고 함수추출해서 구현을 숨기기
</details>

<details>
<summary>조건문을 다형성으로 바꾸기</summary>

- 타입별로 공통부분이 있고 달라지는 부분이 복잡한 분기문에 적용할 수 있음
- 회사 플젝에 적용할 곳이 굉장히 많음
</details>

### 냄새4 - 긴 매개변수 목록
매개변수가 많을 수록 함수의 역할을 이해하기 어려워짐  
의존성이 많다는것은 많은일을 하고있따는 것이기 때문

<details>
<summary>매개변수를 질의 함수로 바꾸기</summary>

- 어떤 매개변수를 다른 매개변수로 알아낼수 있으면 "중복"으로 생각하고 중복제거하기
- 매개변수를 줄이면서 함수 내부에서 새로운 의존성이 생긴다면 고것은 고민해보아야함
</details>

<details>
<summary>flag 매개변수 없애기</summary>

- 보통 함수 내부에 분기를 타게 만듦으로 지양하는게 좋음
- 
</details>

### 냄새6 - 가변 데이터
사이드 이펙트 발생하기 쉬움으로 줄이는 것이 좋음

<details>
<summary>매개변수를 질의 함수로 바꾸기</summary>

- 원본에서 파생되는 값이 따로 변수로 있을때 원본이 가변데이터라면 어딘가에서 파생변수만 바꿔버리거나/안바꿔버려서 기대에 안맞는 결과를 가져올 수 있음
- 원본이 불변값이라면 무방함
</details>

<details>
<summary>여러함수를 변환 함수로 묶기</summary>

- 파생된 값을 만드는 함수가 여러곳에서 반복된다면 새로운 데이터타입을 만들고 그 데이터타입이 파생된 값을 가지고 있게 모을 수 있음
</details>

<details>
<summary>레퍼런스를 값 객체로 바꾸기</summary>

- 객체 내부의 변경을 전파하고 싶은것이 아니라면 vo를 만들어서 불변객체로 바꾸기
- side effect 줄이는방법
</details>
